function get(n){return getRequest(axiosClient.get(n))}function post(n,t){return getRequest(axiosClient.post(n,t))}function deletion(n){return getRequest(axiosClient.delete(n))}function getRequest(n){return n.then(n=>(console.log(n),n)).catch(n=>{console.error(n);throw n;})}function setModal(n,t){$("#photo-modal-label").text(n);$("#imagePreview").attr({src:t});$("#photo-modal").modal("show")}function fadeInImages(n){$(n).each(function(){$(this).delay(Math.random()*500+100).fadeTo("slow",1)})}function getAlertClass(n){switch(n){case 0:return"alert-danger";case 1:return"alert-warning";case 2:return"alert-info"}}function addAlert(n,t){$(t).append('<div class="alert '+getAlertClass(n.severity)+'" role="alert">'+n.text+"<\/div >")}function stopClickEventPropagation(n){document.querySelectorAll(n).forEach(function(n){n.addEventListener("click",function(n){n.stopPropagation()})})}function setAdminMenuItem(n,t){const r=$("#selected-gallery-id").val(),i=$("nav ul li");i.find("a").removeClass("active-menu-item");t===0&&(t=n);n===3&&(t="3."+r);$('[data-menu-level-index="'+t+'"] a').addClass("active-menu-item");i.find("ul.item-show-"+n).toggleClass("show");i.find("#"+n+" span").toggleClass("rotate")}function selectMenuItem(){const n=new URLSearchParams(window.location.search).get("menu");n==="galleries"&&$('.menu li a[id="2"]').click()}function initialisePhotosCatalogueResultsPagination(n,t){photoCatalogueResultsPagination.pagination({items:n,itemsOnPage:pageSize,cssStyle:"dark-theme",onPageClick:function(n){cataloguePhotosGrid.jsGrid("openPage",n)}});showPaginationController(t)}function showPaginationController(n){n?photoCatalogueResultsPagination.show():photoCatalogueResultsPagination.hide()}function loadLookUps(){return new Promise(function(n,t){lookUp.getPhotoCatalogueLookups().then(function(t){initialisePhotoCatalogLookupArrays(t.data);n()}).catch(n=>{n.response.data.messages.forEach(function(n){addAlert(n,photoCatalogueAlerts)}),t()})})}function initialisePhotoCatalogLookupArrays(n){countries=initialiseLookupsArray(n.countries);categories=initialiseLookupsArray(n.categories);palettes=initialiseLookupsArray(n.palettes)}function initialiseLookupsArray(n){return n.push({id:0,name:""}),sortLookupArray(n)}function sortLookupArray(n){return n.sort((n,t)=>n.name<t.name?-1:n.name>t.name?1:0),n}function intialisePhotoCatalogGrid(){cataloguePhotosGrid.jsGrid({width:"100%",autoload:!0,editing:!0,sorting:!0,filtering:!0,pageLoading:!0,pageSize:10,pageIndex:1,controller:{loadData:function(n){return loadPhotos(n)},updateItem:function(n){return updatePhotoDetails(n)}},noDataContent:"No Photos Found",loadIndication:!0,loadIndicationDelay:500,loadMessage:"Please, wait...",loadShading:!0,fields:photosCatalogueFields()})}function loadPhotos(n){let t=n.pageIndex;return photoCatalogueAlerts.empty(),$("#photos-catalogue-results-pagination").hide(),photo.getPhotos(n).then(function(n){return n.data.itemsCount>0&&(initialisePhotosCatalogueResultsPagination(n.data.itemsCount,!0),photoCatalogueResultsPagination.pagination("drawPage",t)),azureStoragePhotosContainerUrl=n.data.azureStoragePhotosContainerUrl,n.data}).catch(function(n){n.response.data.messages.forEach(function(n){addAlert(n,photoCatalogueAlerts)})})}function updatePhotoDetails(n){photoCatalogueAlerts.empty();photo.savePhotoDetails(n.id,n.title,n.country.id,n.category.id,n.palette.id).then(function(n){return n}).catch(n=>{n.response.data.messages.forEach(function(n){addAlert(n,photoCatalogueAlerts)})})}function photosCatalogueFields(){return[{name:"fileName",width:83,title:"",itemTemplate:function(n,t){return $("<img>").attr({src:azureStoragePhotosContainerUrl+t.fileName}).css({width:"100%"}).on("click",function(){setModal(t.fileName,azureStoragePhotosContainerUrl+t.fileName)})}},{name:"id",title:"ID",type:"number",visible:!1,editing:!1},{name:"fileName",title:"Filename",type:"text",width:120,editing:!1},{name:"title",title:"Title",type:"text",width:180},{name:"country.id",title:"Country",type:"select",width:100,items:countries,valueField:"id",textField:"name",align:"left"},{name:"category.id",title:"Category",type:"select",width:100,items:categories,valueField:"id",textField:"name",align:"left"},{name:"palette.id",title:"Palette",type:"select",width:100,items:palettes,valueField:"id",textField:"name",align:"left"},{type:"control",deleteButton:!1,editButton:!1},{name:"camera",title:"Camera",type:"text",width:100,editing:!1},{name:"lens",title:"Lens",type:"text",width:130,editing:!1},{name:"focalLength",title:"Focal Length",type:"text",width:60,editing:!1},{name:"exposureTime",title:"Exposure",type:"text",width:70,editing:!1},{name:"aperturValue",title:"Aperture",type:"text",width:60,editing:!1},{name:"iso",title:"ISO",type:"number",width:70,editing:!1,itemTemplate:function(n){return n===0?"":n}},{name:"dateTaken",title:"Date Taken",type:"text",width:80,editing:!1,itemTemplate:function(n){if(n!=null)return new Date(n).toLocaleDateString()}},]}(function(n){var t={init:function(i){var r=n.extend({items:1,itemsOnPage:1,pages:0,displayedPages:5,edges:2,currentPage:0,useAnchors:!0,hrefTextPrefix:"#page-",hrefTextSuffix:"",prevText:"Prev",nextText:"Next",ellipseText:"&hellip;",ellipsePageSet:!0,cssStyle:"light-theme",listStyle:"",labelMap:[],selectOnClick:!0,nextAtFront:!1,invertPageOrder:!1,useStartEdge:!0,useEndEdge:!0,onPageClick:function(){},onInit:function(){}},i||{}),u=this;return r.pages=r.pages?r.pages:Math.ceil(r.items/r.itemsOnPage)?Math.ceil(r.items/r.itemsOnPage):1,r.currentPage=r.currentPage?r.currentPage-1:r.invertPageOrder?r.pages-1:0,r.halfDisplayed=r.displayedPages/2,this.each(function(){u.addClass(r.cssStyle+" simple-pagination").data("pagination",r);t._draw.call(u)}),r.onInit(),this},selectPage:function(n){return t._selectPage.call(this,n-1),this},prevPage:function(){var n=this.data("pagination");return n.invertPageOrder?n.currentPage<n.pages-1&&t._selectPage.call(this,n.currentPage+1):n.currentPage>0&&t._selectPage.call(this,n.currentPage-1),this},nextPage:function(){var n=this.data("pagination");return n.invertPageOrder?n.currentPage>0&&t._selectPage.call(this,n.currentPage-1):n.currentPage<n.pages-1&&t._selectPage.call(this,n.currentPage+1),this},getPagesCount:function(){return this.data("pagination").pages},setPagesCount:function(n){this.data("pagination").pages=n},getCurrentPage:function(){return this.data("pagination").currentPage+1},destroy:function(){return this.empty(),this},drawPage:function(n){var i=this.data("pagination");return i.currentPage=n-1,this.data("pagination",i),t._draw.call(this),this},redraw:function(){return t._draw.call(this),this},disable:function(){var n=this.data("pagination");return n.disabled=!0,this.data("pagination",n),t._draw.call(this),this},enable:function(){var n=this.data("pagination");return n.disabled=!1,this.data("pagination",n),t._draw.call(this),this},updateItems:function(n){var i=this.data("pagination");i.items=n;i.pages=t._getPages(i);this.data("pagination",i);t._draw.call(this)},updateItemsOnPage:function(n){var i=this.data("pagination");return i.itemsOnPage=n,i.pages=t._getPages(i),this.data("pagination",i),t._selectPage.call(this,0),this},getItemsOnPage:function(){return this.data("pagination").itemsOnPage},_draw:function(){var i=this.data("pagination"),r=t._getInterval(i),u,s,f,o,e;if(t.destroy.call(this),s=typeof this.prop=="function"?this.prop("tagName"):this.attr("tagName"),f=s==="UL"?this:n("<ul"+(i.listStyle?' class="'+i.listStyle+'"':"")+"><\/ul>").appendTo(this),i.prevText&&t._appendItem.call(this,i.invertPageOrder?i.currentPage+1:i.currentPage-1,{text:i.prevText,classes:"prev"}),i.nextText&&i.nextAtFront&&t._appendItem.call(this,i.invertPageOrder?i.currentPage-1:i.currentPage+1,{text:i.nextText,classes:"next"}),i.invertPageOrder){if(r.end<i.pages&&i.edges>0){if(i.useStartEdge)for(o=Math.max(i.pages-i.edges,r.end),u=i.pages-1;u>=o;u--)t._appendItem.call(this,u);i.pages-i.edges>r.end&&i.pages-i.edges-r.end!=1?f.append('<li class="disabled"><span class="ellipse">'+i.ellipseText+"<\/span><\/li>"):i.pages-i.edges-r.end==1&&t._appendItem.call(this,r.end)}}else if(r.start>0&&i.edges>0){if(i.useStartEdge)for(e=Math.min(i.edges,r.start),u=0;u<e;u++)t._appendItem.call(this,u);i.edges<r.start&&r.start-i.edges!=1?f.append('<li class="disabled"><span class="ellipse">'+i.ellipseText+"<\/span><\/li>"):r.start-i.edges==1&&t._appendItem.call(this,i.edges)}if(i.invertPageOrder)for(u=r.end-1;u>=r.start;u--)t._appendItem.call(this,u);else for(u=r.start;u<r.end;u++)t._appendItem.call(this,u);if(i.invertPageOrder){if(r.start>0&&i.edges>0&&(i.edges<r.start&&r.start-i.edges!=1?f.append('<li class="disabled"><span class="ellipse">'+i.ellipseText+"<\/span><\/li>"):r.start-i.edges==1&&t._appendItem.call(this,i.edges),i.useEndEdge))for(e=Math.min(i.edges,r.start),u=e-1;u>=0;u--)t._appendItem.call(this,u)}else if(r.end<i.pages&&i.edges>0&&(i.pages-i.edges>r.end&&i.pages-i.edges-r.end!=1?f.append('<li class="disabled"><span class="ellipse">'+i.ellipseText+"<\/span><\/li>"):i.pages-i.edges-r.end==1&&t._appendItem.call(this,r.end),i.useEndEdge))for(o=Math.max(i.pages-i.edges,r.end),u=o;u<i.pages;u++)t._appendItem.call(this,u);i.nextText&&!i.nextAtFront&&t._appendItem.call(this,i.invertPageOrder?i.currentPage-1:i.currentPage+1,{text:i.nextText,classes:"next"});i.ellipsePageSet&&!i.disabled&&t._ellipseClick.call(this,f)},_getPages:function(n){var t=Math.ceil(n.items/n.itemsOnPage);return t||1},_getInterval:function(n){return{start:Math.ceil(n.currentPage>n.halfDisplayed?Math.max(Math.min(n.currentPage-n.halfDisplayed,n.pages-n.displayedPages),0):0),end:Math.ceil(n.currentPage>n.halfDisplayed?Math.min(n.currentPage+n.halfDisplayed,n.pages):Math.min(n.displayedPages,n.pages))}},_appendItem:function(i,r){var s=this,u,e,f=s.data("pagination"),o=n("<li><\/li>"),h=s.find("ul");i=i<0?0:i<f.pages?i:f.pages-1;u={text:i+1,classes:""};f.labelMap.length&&f.labelMap[i]&&(u.text=f.labelMap[i]);u=n.extend(u,r||{});i==f.currentPage||f.disabled?(f.disabled||u.classes==="prev"||u.classes==="next"?o.addClass("disabled"):o.addClass("active"),e=n('<span class="current">'+u.text+"<\/span>")):(e=f.useAnchors?n('<a href="'+f.hrefTextPrefix+(i+1)+f.hrefTextSuffix+'" class="page-link">'+u.text+"<\/a>"):n("<span >"+u.text+"<\/span>"),e.click(function(n){return t._selectPage.call(s,i,n)}));u.classes&&e.addClass(u.classes);o.append(e);h.length?h.append(o):s.append(o)},_selectPage:function(n,i){var r=this.data("pagination");r.currentPage=n;r.selectOnClick&&t._draw.call(this);return r.onPageClick(n+1,i)},_ellipseClick:function(i){var f=this,r=this.data("pagination"),u=i.find(".ellipse");u.addClass("clickable").parent().removeClass("disabled");u.click(function(){if(!r.disable){var i=n(this),e=(parseInt(i.parent().prev().text(),10)||0)+1;i.html('<input type="number" min="1" max="'+r.pages+'" step="1" value="'+e+'">').find("input").focus().click(function(n){n.stopPropagation()}).keyup(function(i){var e=n(this).val();i.which===13&&e!==""?e>0&&e<=r.pages&&t._selectPage.call(f,e-1):i.which===27&&u.empty().html(r.ellipseText)}).bind("blur",function(){var i=n(this).val();return i!==""&&t._selectPage.call(f,i-1),u.empty().html(r.ellipseText),!1})}return!1})}};n.fn.pagination=function(i){if(t[i]&&i.charAt(0)!="_")return t[i].apply(this,Array.prototype.slice.call(arguments,1));if(typeof i!="object"&&i)n.error("Method "+i+" does not exist on jQuery.pagination");else return t.init.apply(this,arguments)}})(jQuery);const baseUrl="https://"+window.location.host,axiosClient=axios.create({baseURL:baseUrl,headers:{RequestVerificationToken:$('input[name="__RequestVerificationToken"]').val()}});class Gallery{searchPhotos(n,t,i,r,u,f){let e=this.filter(n,t,i,r,u,f);return new Promise(function(n,t){post("/admin/gallery/search",e).then(function(t){return n(t)}).catch(n=>t(n))})}savePhotoToGallery(n,t,i){let r=this.photo(n,t,i);return new Promise(function(n,t){post("/admin/gallery-photos/add",r).then(function(t){return n(t)}).catch(n=>t(n))})}movePhotoInGallery(n,t,i){let r=this.photo(n,t,i);return new Promise(function(n,t){post("/admin/gallery-photos/move",r).then(function(t){return n(t)}).catch(n=>t(n))})}removePhotoInGallery(n,t,i){let r=this.photo(n,t,i);return new Promise(function(n,t){post("/admin/gallery-photos/remove",r).then(function(t){return n(t)}).catch(n=>t(n))})}saveGalleryName(n,t){let i=this.gallery(n,t);return new Promise(function(n,t){post("/admin/gallery/save/name",i).then(function(t){return n(t)}).catch(n=>t(n))})}saveNewGallery(n){let t=this.gallery(0,n);return new Promise(function(n,i){post("/admin/gallery/new/save",t).then(function(t){return n(t)}).catch(n=>i(n))})}deleteGallery(n){return new Promise(function(t,i){deletion("/admin/gallery/delete/"+n).then(function(n){return t(n)}).catch(n=>i(n))})}photo(n,t,i){return{galleryId:n,photoId:t,order:i}}gallery(n,t){return{id:n,name:t}}filter(n,t,i,r,u,f){return{title:n,countryId:parseInt(t),categoryId:parseInt(i),paletteId:parseInt(r),pageIndex:parseInt(u),pageSize:parseInt(f)}}}class Photo{getPhotos(n){let t={pageSize:n.pageSize,pageIndex:n.pageIndex,sortField:n.sortField===undefined?"":n.sortField,sortOrder:n.sortOrder===undefined?"":n.sortOrder,title:n.title,countryId:n.country.id,categoryId:n.category.id,paletteId:n.palette.id,aperturValue:n.aperturValue,camera:n.camera,dateTaken:n.dateTaken,exposureTime:n.exposureTime,fileName:n.fileName,focalLength:n.focalLength,id:n.id===undefined?0:n.id,iso:n.iso===undefined?0:n.iso,lens:n.lens};return new Promise(function(n,i){post("/admin/photo/catalog",t).then(function(t){return n(t)}).catch(n=>i(n))})}savePhotoDetails(n,t,i,r,u){const f={id:n,title:t,countryId:i,categoryId:r,paletteId:u};return new Promise(function(n,t){post("/admin/photo/catalog/update-photo",f).then(function(t){return n(t)}).catch(n=>t(n))})}addPhotoToGallerys(n){return new Promise(function(t,i){post("/favourites/add-photo/"+n).then(function(n){return t(n)}).catch(n=>i(n))})}deletePhotoFromGallerys(n){return new Promise(function(t,i){deletion("/favourites/delete-photo/"+n).then(function(n){return t(n)}).catch(n=>i(n))})}importPhotos(n){return new Promise(function(t,i){post("/admin/photo/import",n).then(function(n){return t(n)}).catch(n=>i(n))})}updateCataloguePhoto(n){return new Promise(function(t,i){post("/admin/photo/catalog/update-photo",n).then(function(n){return t(n)}).catch(n=>i(n))})}}class LookUp{getPhotoCatalogueLookups(){return new Promise(function(n,t){get("/admin/lookup/photo-catalogue").then(function(t){return n(t)}).catch(n=>t(n))})}}$(document).on("click",".photo-modal-close, .photo-modal-close-small",function(){$("#photo-modal").modal("hide")});document.addEventListener("DOMContentLoaded",function(){stopClickEventPropagation(".dropdown-menu")});const gallery=new Gallery;let navMenuListItem=$("nav ul li"),newGalleryName=$("#new-gallery-name"),newGalleryAlerts=$("#new-gallery-alert");$(function(){selectMenuItem()});$(".sidebar ul li a").click(function(){var n=$(this).attr("id");navMenuListItem.find("ul.item-show-"+n).toggleClass("show");navMenuListItem.find("#"+n+" span").toggleClass("rotate")});$("nav ul li a").click(function(){navMenuListItem.find("a").removeClass("active");$(this).addClass("active")});$(document).on("click","#new-gallery",function(){newGalleryName.val("");newGalleryAlerts.empty();$("#new-gallery-modal").modal("show")});$(document).on("click","#save-new-gallery",function(){let n=newGalleryName.val();newGalleryAlerts.empty();n!=""&&gallery.saveNewGallery(n).then(function(n){$("#selected-gallery-id").val(n.data.id);window.location=baseUrl+"/admin/gallery/"+n.data.id}).catch(n=>{n.response.data.messages.forEach(function(n){addAlert(n,newGalleryAlerts)})})});document.addEventListener("DOMContentLoaded",function(){stopClickEventPropagation(".dropdown-menu")});const photo=new Photo,lookUp=new LookUp,menuItemIndex=2,subMenuItemIndex=2.2;let countries=[],categories=[],palettes=[],pageSize=10,azureStoragePhotosContainerUrl="",photoCatalogueAlerts=$("#photo-catalogue-alert"),cataloguePhotosGrid=$("#catalog-photos-grid"),photoCatalogueResultsPagination=$("#photo-catalogue-results-pagination");$(function(){setAdminMenuItem(menuItemIndex,subMenuItemIndex);loadLookUps().then(function(){intialisePhotoCatalogGrid()});initialisePhotosCatalogueResultsPagination(1,!1);history.pushState("",document.title,window.location.pathname)});
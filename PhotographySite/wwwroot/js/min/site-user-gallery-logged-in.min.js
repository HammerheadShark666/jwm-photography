function t(n,t){return a(l.post(n,t))}function st(n){return a(l.delete(n))}function a(n){return n.then(n=>(console.log(n),n)).catch(n=>{console.error(n);throw n;})}function ht(n){$(n).each(function(){$(this).delay(Math.random()*500+100).fadeTo("slow",1)})}function ct(n){switch(n){case 0:return"alert-danger";case 1:return"alert-warning";case 2:return"alert-info"}}function n(n,t){$(t).append('<div class="alert '+ct(n.severity)+'" role="alert">'+n.text+"<\/div >")}function v(n){document.querySelectorAll(n).forEach(function(n){n.addEventListener("click",function(n){n.stopPropagation()})})}function lt(n,t){$("#photo-modal-label").text(n);$("#imagePreview").attr({src:t});$("#photo-modal").modal("show")}function g(){var n=$("#user-galleries"),t=$("li",n).get(),r=t[0],i;t.shift();i=nt(t);i.splice(0,0,r);n=y(n,i)}function vt(){var n=$(".site-galleries"),t=$("li.site-gallery-menu-item",n),i=$("li.user-gallery-menu-item",n),r=$("li.seperator",n),u=nt(i),n=y(n,t);n.append(r);n=y(n,u)}function nt(n){return n.sort(function(n,t){var i=$(n).text().trim().toUpperCase(),r=$(t).text().trim().toUpperCase();return i<r?-1:1}),n}function y(n,t){return $.each(t,function(t,i){n.append(i)}),n}function yt(){$("#search-country-select").prepend(p("Country"));$("#search-category-select").prepend(p("Category"));$("#search-palette-select").prepend(p("Palette"))}function p(n){return"<option value='0' selected='selected'>Select "+n+"...<\/option>"}function et(n,t){u.pagination({items:n,itemsOnPage:tt,cssStyle:"dark-theme",onPageClick:function(n){ot(n)}});pt(t)}function pt(n){n?u.show():u.hide()}function ot(t){ft.empty();let f=parseInt($("#search-country-select").val()),e=parseInt($("#search-category-select").val()),o=parseInt($("#search-palette-select").val()),s=$("#gallery-search-title").val();i.searchPhotos(s,f,e,o,t,tt).then(function(n){it=n.data.azureStoragePhotosContainerUrl;ft.append(wt(n.data.photos));et(n.data.numberOfPhotos,!0);u.pagination("drawPage",t)}).catch(t=>{t.response.data.messages.forEach(function(t){n(t,r)})})}function wt(n){let t="";return n.forEach(function(n){ri(n.id)||(t=t+bt(n))}),t}function bt(n){return"<li><img data-photo-id='"+n.id+"' data-title='"+n.title+"' class='draggable-img gallery-thumbnail' src='"+it+n.fileName+"' /><\/li>"}function kt(){let n="",t="";$("#gallery-source, #gallery-destination").sortable({helper:"clone",opacity:.5,cursor:"crosshair",connectWith:".list",receive:function(n){t==""&&(t=n.target.id)},start:function(){n="";t=""},update:function(t){n==""&&(n=t.target.id)},stop:function(i,r){dt(r,n,t)}});$("#gallery-source, #gallery-destination").disableSelection()}function dt(n,t,i){let r=$(n.item[0]).find("img").attr("data-photo-id"),u=$("#selected-user-gallery-id").val();t==="gallery-source"&&i==="gallery-destination"?gt(n.item,u,r):t==="gallery-destination"&&i===""?ni(n.item,u,r):(t==="gallery-destination"&&i==="gallery-source"||t===""&&i==="")&&ti(n.item,u,r)}function gt(t,u,f){var e=$(t).prevAll().length+1;i.savePhotoToUserGallery(u,f,e).then(function(){w(t,e)}).catch(t=>{t.response.data.messages.forEach(function(t){n(t,r)})})}function ni(t,u,f){var e=$(t).prevAll().length+1;i.movePhotoInUserGallery(u,f,e).then(function(){w(t)}).catch(t=>{t.response.data.messages.forEach(function(t){n(t,r)})})}function ti(t,u,f){var e=$(t).prevAll().length;i.removePhotoInUserGallery(u,f,e).then(function(){w(t)}).catch(t=>{t.response.data.messages.forEach(function(t){n(t,r)})})}function w(n){let t=1,i=$(n).parent().children();i.each(function(n,i){$(i).find("img").attr("data-photo-order",t);t++})}function ii(){let n=$("nav ul li");n.removeClass("active");var t=$("#selected-gallery-id").val(),i=$('[data-gallary-menu-id="'+t+'"]');$(i).addClass("active");n.find("ul.item-show-2").toggleClass("show");n.find("#2 span").toggleClass("rotate")}function ri(n){let t=!1;return $("#gallery-destination li img").each(function(i,r){let u=parseInt($(r).attr("data-photo-id"));if(u===n){t=!0;return}}),t}(function(n){var t={init:function(i){var r=n.extend({items:1,itemsOnPage:1,pages:0,displayedPages:5,edges:2,currentPage:0,useAnchors:!0,hrefTextPrefix:"#page-",hrefTextSuffix:"",prevText:"Prev",nextText:"Next",ellipseText:"&hellip;",ellipsePageSet:!0,cssStyle:"light-theme",listStyle:"",labelMap:[],selectOnClick:!0,nextAtFront:!1,invertPageOrder:!1,useStartEdge:!0,useEndEdge:!0,onPageClick:function(){},onInit:function(){}},i||{}),u=this;return r.pages=r.pages?r.pages:Math.ceil(r.items/r.itemsOnPage)?Math.ceil(r.items/r.itemsOnPage):1,r.currentPage=r.currentPage?r.currentPage-1:r.invertPageOrder?r.pages-1:0,r.halfDisplayed=r.displayedPages/2,this.each(function(){u.addClass(r.cssStyle+" simple-pagination").data("pagination",r);t._draw.call(u)}),r.onInit(),this},selectPage:function(n){return t._selectPage.call(this,n-1),this},prevPage:function(){var n=this.data("pagination");return n.invertPageOrder?n.currentPage<n.pages-1&&t._selectPage.call(this,n.currentPage+1):n.currentPage>0&&t._selectPage.call(this,n.currentPage-1),this},nextPage:function(){var n=this.data("pagination");return n.invertPageOrder?n.currentPage>0&&t._selectPage.call(this,n.currentPage-1):n.currentPage<n.pages-1&&t._selectPage.call(this,n.currentPage+1),this},getPagesCount:function(){return this.data("pagination").pages},setPagesCount:function(n){this.data("pagination").pages=n},getCurrentPage:function(){return this.data("pagination").currentPage+1},destroy:function(){return this.empty(),this},drawPage:function(n){var i=this.data("pagination");return i.currentPage=n-1,this.data("pagination",i),t._draw.call(this),this},redraw:function(){return t._draw.call(this),this},disable:function(){var n=this.data("pagination");return n.disabled=!0,this.data("pagination",n),t._draw.call(this),this},enable:function(){var n=this.data("pagination");return n.disabled=!1,this.data("pagination",n),t._draw.call(this),this},updateItems:function(n){var i=this.data("pagination");i.items=n;i.pages=t._getPages(i);this.data("pagination",i);t._draw.call(this)},updateItemsOnPage:function(n){var i=this.data("pagination");return i.itemsOnPage=n,i.pages=t._getPages(i),this.data("pagination",i),t._selectPage.call(this,0),this},getItemsOnPage:function(){return this.data("pagination").itemsOnPage},_draw:function(){var i=this.data("pagination"),r=t._getInterval(i),u,s,f,o,e;if(t.destroy.call(this),s=typeof this.prop=="function"?this.prop("tagName"):this.attr("tagName"),f=s==="UL"?this:n("<ul"+(i.listStyle?' class="'+i.listStyle+'"':"")+"><\/ul>").appendTo(this),i.prevText&&t._appendItem.call(this,i.invertPageOrder?i.currentPage+1:i.currentPage-1,{text:i.prevText,classes:"prev"}),i.nextText&&i.nextAtFront&&t._appendItem.call(this,i.invertPageOrder?i.currentPage-1:i.currentPage+1,{text:i.nextText,classes:"next"}),i.invertPageOrder){if(r.end<i.pages&&i.edges>0){if(i.useStartEdge)for(o=Math.max(i.pages-i.edges,r.end),u=i.pages-1;u>=o;u--)t._appendItem.call(this,u);i.pages-i.edges>r.end&&i.pages-i.edges-r.end!=1?f.append('<li class="disabled"><span class="ellipse">'+i.ellipseText+"<\/span><\/li>"):i.pages-i.edges-r.end==1&&t._appendItem.call(this,r.end)}}else if(r.start>0&&i.edges>0){if(i.useStartEdge)for(e=Math.min(i.edges,r.start),u=0;u<e;u++)t._appendItem.call(this,u);i.edges<r.start&&r.start-i.edges!=1?f.append('<li class="disabled"><span class="ellipse">'+i.ellipseText+"<\/span><\/li>"):r.start-i.edges==1&&t._appendItem.call(this,i.edges)}if(i.invertPageOrder)for(u=r.end-1;u>=r.start;u--)t._appendItem.call(this,u);else for(u=r.start;u<r.end;u++)t._appendItem.call(this,u);if(i.invertPageOrder){if(r.start>0&&i.edges>0&&(i.edges<r.start&&r.start-i.edges!=1?f.append('<li class="disabled"><span class="ellipse">'+i.ellipseText+"<\/span><\/li>"):r.start-i.edges==1&&t._appendItem.call(this,i.edges),i.useEndEdge))for(e=Math.min(i.edges,r.start),u=e-1;u>=0;u--)t._appendItem.call(this,u)}else if(r.end<i.pages&&i.edges>0&&(i.pages-i.edges>r.end&&i.pages-i.edges-r.end!=1?f.append('<li class="disabled"><span class="ellipse">'+i.ellipseText+"<\/span><\/li>"):i.pages-i.edges-r.end==1&&t._appendItem.call(this,r.end),i.useEndEdge))for(o=Math.max(i.pages-i.edges,r.end),u=o;u<i.pages;u++)t._appendItem.call(this,u);i.nextText&&!i.nextAtFront&&t._appendItem.call(this,i.invertPageOrder?i.currentPage-1:i.currentPage+1,{text:i.nextText,classes:"next"});i.ellipsePageSet&&!i.disabled&&t._ellipseClick.call(this,f)},_getPages:function(n){var t=Math.ceil(n.items/n.itemsOnPage);return t||1},_getInterval:function(n){return{start:Math.ceil(n.currentPage>n.halfDisplayed?Math.max(Math.min(n.currentPage-n.halfDisplayed,n.pages-n.displayedPages),0):0),end:Math.ceil(n.currentPage>n.halfDisplayed?Math.min(n.currentPage+n.halfDisplayed,n.pages):Math.min(n.displayedPages,n.pages))}},_appendItem:function(i,r){var s=this,u,e,f=s.data("pagination"),o=n("<li><\/li>"),h=s.find("ul");i=i<0?0:i<f.pages?i:f.pages-1;u={text:i+1,classes:""};f.labelMap.length&&f.labelMap[i]&&(u.text=f.labelMap[i]);u=n.extend(u,r||{});i==f.currentPage||f.disabled?(f.disabled||u.classes==="prev"||u.classes==="next"?o.addClass("disabled"):o.addClass("active"),e=n('<span class="current">'+u.text+"<\/span>")):(e=f.useAnchors?n('<a href="'+f.hrefTextPrefix+(i+1)+f.hrefTextSuffix+'" class="page-link">'+u.text+"<\/a>"):n("<span >"+u.text+"<\/span>"),e.click(function(n){return t._selectPage.call(s,i,n)}));u.classes&&e.addClass(u.classes);o.append(e);h.length?h.append(o):s.append(o)},_selectPage:function(n,i){var r=this.data("pagination");r.currentPage=n;r.selectOnClick&&t._draw.call(this);return r.onPageClick(n+1,i)},_ellipseClick:function(i){var f=this,r=this.data("pagination"),u=i.find(".ellipse");u.addClass("clickable").parent().removeClass("disabled");u.click(function(){if(!r.disable){var i=n(this),e=(parseInt(i.parent().prev().text(),10)||0)+1;i.html('<input type="number" min="1" max="'+r.pages+'" step="1" value="'+e+'">').find("input").focus().click(function(n){n.stopPropagation()}).keyup(function(i){var e=n(this).val();i.which===13&&e!==""?e>0&&e<=r.pages&&t._selectPage.call(f,e-1):i.which===27&&u.empty().html(r.ellipseText)}).bind("blur",function(){var i=n(this).val();return i!==""&&t._selectPage.call(f,i-1),u.empty().html(r.ellipseText),!1})}return!1})}};n.fn.pagination=function(i){if(t[i]&&i.charAt(0)!="_")return t[i].apply(this,Array.prototype.slice.call(arguments,1));if(typeof i!="object"&&i)n.error("Method "+i+" does not exist on jQuery.pagination");else return t.init.apply(this,arguments)}})(jQuery);let b;document.addEventListener("DOMContentLoaded",function(){b=new bootstrap.Modal(document.getElementById("modal-message-popup"),{keyboard:!1})});class h{searchPhotos(n,i,r,u,f,e){let o=this.filter(n,i,r,u,f,e);return new Promise(function(n,i){t("/favourites/search",o).then(function(t){return n(t)}).catch(n=>i(n))})}savePhotoToUserGallery(n,i,r){let u=this.photo(n,i,r);return new Promise(function(n,i){t("/user/gallery-photos/add",u).then(function(t){return n(t)}).catch(n=>i(n))})}movePhotoInUserGallery(n,i,r){let u=this.photo(n,i,r);return new Promise(function(n,i){t("/user/gallery-photos/move",u).then(function(t){return n(t)}).catch(n=>i(n))})}removePhotoInUserGallery(n,i,r){let u=this.photo(n,i,r);return new Promise(function(n,i){t("/user/gallery-photos/remove",u).then(function(t){return n(t)}).catch(n=>i(n))})}saveUserGalleryName(n,i){let r=this.userGallery(n,i),u="/user/gallery/"+(n==0?"add":"update");return new Promise(function(n,i){t(u,r).then(function(t){return n(t)}).catch(n=>i(n))})}saveNewUserGallery(n){let i=this.userGallery(0,n);return new Promise(function(n,r){t("/user/gallery/add",i).then(function(t){return n(t)}).catch(n=>r(n))})}deleteUserGallery(n){return new Promise(function(t,i){st("/user/gallery/delete/"+n).then(function(n){return t(n)}).catch(n=>i(n))})}photo(n,t,i){return{userGalleryId:n,photoId:t,order:i}}userGallery(n,t){return{id:n,name:t}}filter(n,t,i,r,u,f){return{title:n,countryId:parseInt(t),categoryId:parseInt(i),paletteId:parseInt(r),pageIndex:parseInt(u),pageSize:parseInt(f)}}}const c="https://"+window.location.host,l=axios.create({baseURL:c,headers:{RequestVerificationToken:$('input[name="__RequestVerificationToken"]').val()}});$(document).on("click",".photo-modal-close, .photo-modal-close-small",function(){$("#photo-modal").modal("hide")});const at=new h;let f=$("#add-user-gallery-name-alerts"),k=$("#new-user-gallery-name"),d=$("#new-user-gallery-modal"),e=$("nav ul li");$(function(){f.empty()});document.addEventListener("DOMContentLoaded",function(){v(".site-galleries");v(".user-galleries");v(".new-gallery-item")});$("#menu-bar li a").click(function(){var n=$(this).attr("id");e.find("ul.item-show-"+n).toggleClass("show");e.find("#"+n+" span").toggleClass("rotate")});e.click(function(){e.removeClass("active");$(this).addClass("active")});$(document).on("click","#new-user-gallery",function(){d.modal("show");k.val("");f.empty()});$(document).on("click","#save-user-new-gallery",function(){let t=k.val();f.empty();t!=""&&at.saveNewUserGallery(t).then(function(n){d.modal("hide");$("#user-galleries").append("<li><a href='/user/gallery/"+n.data.id+"'>"+n.data.name+"<\/a><\/li>");$(".site-galleries").append("<li class='user-gallery-menu-item' data-user-gallary-menu-id='"+n.data.id+"'><a class='dropdown-item' href='/gallery/user/"+n.data.id+"'>"+n.data.name+"<\/a><\/li>");g();vt();window.location=c+"/user/gallery/"+n.data.id}).catch(t=>{t.response.data.messages.forEach(function(t){n(t,f)})})});const i=new h;let tt=20,it="",r=$("#gallery-alerts"),u=$("#user-gallery-search-photos-results-pagination"),o=$("#edit-user-gallery-name-alerts"),rt=$("#edit-user-gallery-name-modal"),s=$("#edit-user-gallery-name"),ut=$("#delete-user-gallery-modal"),ft=$("#gallery-source");$(function(){yt();ii();kt();et(1,!1);history.pushState("",document.title,window.location.pathname);ht($("#user-gallery-images > div > a > img"));r.empty()});$(document).on("click",".gallery-thumbnail",function(){lt($(this).attr("data-title"),$(this).attr("src"))});$(document).on("click",".edit-user-gallery-name",function(){let n=$(this).attr("data-gallery-name");rt.modal("show");s.val(n);o.empty()});$(document).on("click",".delete-user-gallery",function(){ut.modal("show")});$(document).on("click","#delete-user-gallery",function(){let t=$("#selected-user-gallery-id").val();i.deleteUserGallery(t).then(function(){ut.modal("hide");window.location=c}).catch(t=>{t.responseJSON.messages.forEach(function(t){n(t,o)})})});$(document).on("click",".gallery-search-photos-search-button",function(){u.hide();ot(1)});$(document).on("click","#save-user-gallery-name",function(){let r=$("#selected-user-gallery-id").val(),t=s.val();o.empty();t!=""&&i.saveUserGalleryName(r,t).then(function(){rt.modal("hide");s.val("");s.attr("data-gallery-name",t);$("#user-galley-name-title").text("Gallery ("+t+")");$('li[data-user-gallary-menu-id="'+r+'"]').find("a").text(t);g()}).catch(t=>{t.response.data.messages.forEach(function(t){n(t,o)})})});export{h as UserGallery};